{"code":"import { defineComponent } from \"vue\";\nimport { testInovkeDownloadFile } from '@/uni_modules/test-invoke-network-api';\nexport default defineComponent({\n    data() {\n        return {\n            title: 'downloadFile',\n            imageSrc: '',\n            task: null,\n            //自动化测试例专用\n            jest_result: false\n        };\n    },\n    onLoad() {\n    },\n    onUnload() {\n        var _a;\n        // this.imageSrc = '';\n        uni.hideLoading();\n        (_a = this.task) === null || _a === void 0 ? void 0 : _a.abort();\n    },\n    methods: {\n        downloadImage: function () {\n            var _a;\n            uni.showLoading({\n                title: '下载中'\n            });\n            var self = this;\n            this.task = uni.downloadFile({\n                url: \"https://qiniu-web-assets.dcloud.net.cn/unidoc/zh/uni-app.png\",\n                success: (res) => {\n                    uni.__log__('log', 'at pages/API/download-file/download-file.uvue:56', 'downloadFile success, res is', res.tempFilePath);\n                    self.imageSrc = res.tempFilePath;\n                    uni.hideLoading();\n                },\n                fail: (err) => {\n                    uni.__log__('log', 'at pages/API/download-file/download-file.uvue:61', 'downloadFile fail, err is:', err);\n                    uni.hideLoading();\n                }\n            });\n            (_a = this.task) === null || _a === void 0 ? void 0 : _a.onProgressUpdate((update) => {\n                uni.__log__('log', 'at pages/API/download-file/download-file.uvue:66', \"progress : \", update.progress);\n            });\n        },\n        //自动化测试例专用\n        jest_downloadFile() {\n            uni.downloadFile({\n                url: \"https://qiniu-web-assets.dcloud.net.cn/unidoc/zh/uni-app.png\",\n                success: () => {\n                    this.jest_result = true;\n                },\n                fail: () => {\n                    this.jest_result = false;\n                }\n            });\n        },\n        jest_downloadFile_with_uni_env() {\n            uni.downloadFile({\n                url: \"https://qiniu-web-assets.dcloud.net.cn/unidoc/zh/uni-app.png\",\n                filePath: `${uni.env.CACHE_PATH}/a/b/`,\n                success: () => {\n                    this.jest_result = true;\n                },\n                fail: () => {\n                    this.jest_result = false;\n                }\n            });\n        },\n        jest_set_cookie() {\n            uni.request({\n                url: \"https://request.dcloud.net.cn/api/http/header/setCookie\",\n                method: \"GET\",\n                timeout: 6000,\n                sslVerify: false,\n                withCredentials: true,\n                firstIpv4: false,\n                success: () => {\n                    this.jest_cookie_download(true);\n                },\n                fail: () => {\n                    this.jest_result = false;\n                },\n            });\n        },\n        jest_delete_cookie() {\n            uni.request({\n                url: \"https://request.dcloud.net.cn/api/http/header/deleteCookie\",\n                method: \"GET\",\n                timeout: 6000,\n                sslVerify: false,\n                withCredentials: true,\n                firstIpv4: false,\n                success: () => {\n                    this.jest_cookie_download(false);\n                },\n                fail: () => {\n                    this.jest_result = false;\n                },\n            });\n        },\n        jest_cookie_download(needCookie) {\n            uni.downloadFile({\n                url: \"https://request.dcloud.net.cn/api/http/header/download\",\n                success: () => {\n                    this.jest_result = needCookie ? true : false;\n                },\n                fail: () => {\n                    this.jest_result = needCookie ? false : true;\n                }\n            });\n        },\n        jest_uts_module_invoked() {\n            testInovkeDownloadFile({\n                success: (res = null) => {\n                    uni.__log__('log', 'at pages/API/download-file/download-file.uvue:143', \"success :\", res);\n                    this.jest_result = true;\n                },\n                fail: (err = null) => {\n                    uni.__log__('log', 'at pages/API/download-file/download-file.uvue:147', \"fail :\", err);\n                    this.jest_result = false;\n                }\n            });\n        },\n        jest_special_characters_download() {\n            uni.downloadFile({\n                url: \"https://web-ext-storage.dcloud.net.cn/hello-uni-app-x/1789834995055525889-你好%23你好.png\",\n                success: (res) => {\n                    this.jest_result = true;\n                    uni.__log__('log', 'at pages/API/download-file/download-file.uvue:158', \"res :\", res);\n                },\n                fail: () => {\n                    this.jest_result = false;\n                }\n            });\n        }\n    }\n});\n//# sourceMappingURL=/Users/gaoruicheng/Documents/DcloudProject/uniapp-bugs/uniapp-bugs-main/singlePage/uniapp-hello-x/pages/API/download-file/download-file.uvue?vue&type=script&lang.uts.js.map","references":[],"uniExtApis":["uni.hideLoading","uni.showLoading","uni.downloadFile","uni.__log__","uni.request"],"map":"{\"version\":3,\"file\":\"download-file.uvue?vue&type=script&lang.uts.js\",\"sourceRoot\":\"\",\"sources\":[\"download-file.uvue?vue&type=script&lang.uts\"],\"names\":[],\"mappings\":\"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\"}"}
