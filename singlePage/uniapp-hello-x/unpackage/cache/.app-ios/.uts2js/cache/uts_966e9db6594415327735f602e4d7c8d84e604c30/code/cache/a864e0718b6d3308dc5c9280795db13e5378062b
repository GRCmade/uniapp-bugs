{"code":"import { defineComponent } from \"vue\";\nimport { objectAssign } from \"../../js_sdk/js_sdk\";\nexport default defineComponent({\n    data() {\n        return {\n            myOptions: new UTSJSONObject({\n                total_fee: \"\",\n            }),\n            insideData: new UTSJSONObject({\n                currentProviders: [],\n                images: new UTSJSONObject({\n                    alipay: \"\",\n                    wxpay: \"\"\n                })\n            }),\n            adpid: \"\",\n            return_url: \"\",\n            main_color: \"\", // 支付成功页面的主色调\n        };\n    },\n    // 监听 - 页面每次【加载时】执行(如：前进)\n    onLoad(options = null) {\n        let optionsStr = options['options'];\n        if (optionsStr != null && optionsStr != \"\") {\n            let newOptions = new UTSJSONObject(UTS.JSON.parse(decodeURI(optionsStr)));\n            this.myOptions = new UTSJSONObject(newOptions);\n        }\n        uni.__log__('log', 'at uni_modules/uni-pay-x/pages/pay-desk/pay-desk.uvue:72', 'myOptions: ', this.myOptions);\n    },\n    // 监听 - 页面【首次渲染完成时】执行。注意如果渲染速度快，会在页面进入动画完成前触发\n    onReady() { },\n    // 监听 - 页面每次【显示时】执行(如：前进和返回) (页面每次出现在屏幕上都触发，包括从下级页面点返回露出当前页面)\n    onShow() { },\n    // 监听 - 页面每次【隐藏时】执行(如：返回)\n    onHide() { },\n    // 函数\n    methods: {\n        // 监听 - 支付组件加载完毕事件\n        onMounted(insideData) {\n            this.insideData['currentProviders'] = insideData.getArray('currentProviders');\n            this.insideData['images'] = new UTSJSONObject(insideData.getJSON('images'));\n        },\n        // 发起支付\n        createOrder(data) {\n            this.myOptions = objectAssign(this.myOptions, data);\n            const payInstance = this.$refs[\"payRef\"];\n            payInstance.createOrder(this.myOptions);\n        },\n        // 根据provider发起支付\n        createOrderByProvider(provider) {\n            this.createOrder(new UTSJSONObject({\n                provider\n            }));\n        },\n        // 监听事件 - 支付成功\n        onSuccess(res) {\n            let out_trade_no = res['out_trade_no'];\n            let pay_order = new UTSJSONObject(res.getJSON('pay_order'));\n            let order_no = pay_order['order_no'];\n            //let pay_date = pay_order['pay_date'] as string;\n            let total_fee = pay_order.getNumber('total_fee');\n            if (total_fee == null) {\n                total_fee = 0;\n            }\n            let return_url = this.return_url;\n            let adpid = this.adpid;\n            let main_color = this.main_color;\n            uni.__log__('log', 'at uni_modules/uni-pay-x/pages/pay-desk/pay-desk.uvue:113', 'success: ', res);\n            let user_order_success = res.getBoolean('user_order_success');\n            if (user_order_success != null && user_order_success != true) {\n                // 代表用户已付款，且你自己写的回调成功并正确执行了\n                uni.redirectTo({\n                    url: `/uni_modules/uni-pay-x/pages/success/success?out_trade_no=${out_trade_no}&order_no=${order_no}&total_fee=${total_fee}&adpid=${adpid}&return_url=${return_url}&main_color=${main_color}`\n                });\n            }\n            else {\n                // 代表用户已付款，但你自己写的回调执行失败（通常是因为你的回调代码有问题）\n            }\n        },\n        // 监听事件 - 支付失败\n        onFail(err) {\n            uni.__log__('log', 'at uni_modules/uni-pay-x/pages/pay-desk/pay-desk.uvue:127', 'fail: ', err);\n        },\n        // 监听事件 - 取消支付\n        onCancel(err) {\n            uni.__log__('log', 'at uni_modules/uni-pay-x/pages/pay-desk/pay-desk.uvue:132', 'cancel: ', err);\n        },\n        amountFormat(totalFee = null) {\n            if (totalFee == null) {\n                return \"0\";\n            }\n            else {\n                return (totalFee / 100).toFixed(2);\n            }\n        },\n        // 检测provider\n        checkProvider(provider) {\n            let currentProviders = this.insideData.getArray('currentProviders');\n            return currentProviders != null && currentProviders.indexOf(provider) > -1 ? true : false;\n        }\n    },\n    // 监听器\n    watch: {},\n    // 计算属性\n    computed: {}\n});\n//# sourceMappingURL=/Users/gaoruicheng/Documents/DcloudProject/uniapp-bugs/uniapp-bugs-main/singlePage/uniapp-hello-x/uni_modules/uni-pay-x/pages/pay-desk/pay-desk.uvue?vue&type=script&lang.uts.js.map","references":["/Users/gaoruicheng/Documents/DcloudProject/uniapp-bugs/uniapp-bugs-main/singlePage/uniapp-hello-x/uni_modules/uni-pay-x/js_sdk/js_sdk.uts"],"uniExtApis":["uni.__log__","uni.redirectTo"],"map":"{\"version\":3,\"file\":\"pay-desk.uvue?vue&type=script&lang.uts.js\",\"sourceRoot\":\"\",\"sources\":[\"pay-desk.uvue?vue&type=script&lang.uts\"],\"names\":[],\"mappings\":\"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\"}"}
