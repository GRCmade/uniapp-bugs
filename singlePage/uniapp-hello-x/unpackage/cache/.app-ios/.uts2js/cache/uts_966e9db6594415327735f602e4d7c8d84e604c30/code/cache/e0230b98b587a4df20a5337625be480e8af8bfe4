{"code":"import { defineComponent } from \"vue\";\nimport { easeInOutCubic } from './util';\nlet elId = 0;\nexport default defineComponent({\n    name: \"circle\",\n    props: {\n        speed: {\n            type: Number,\n            default: 16,\n        },\n        size: {\n            type: Number,\n            default: 20,\n        },\n        color: {\n            type: String,\n            default: '#666',\n        }\n    },\n    data() {\n        // 防止多调用，随机元素id\n        elId += 1;\n        const elID = `Uni_Load_Circle_${elId}`;\n        return {\n            elId: elID,\n            timer: 0,\n        };\n    },\n    computed: {\n        iconsSize() {\n            return (this.size / 10) + 1;\n        }\n    },\n    mounted() {\n        this.init();\n    },\n    unmounted() {\n        // 组件卸载时，需要卸载定时器，优化性能，防止页面卡死\n        clearInterval(this.timer);\n    },\n    methods: {\n        /**\n         * 初始化圆环\n         */\n        init() {\n            const refs = this.$refs[this.elId];\n            let ctx = refs.getDrawableContext();\n            this.build_circular(ctx);\n        },\n        /**\n         * 构建圆环动画\n         */\n        build_circular(ctx) {\n            let startAngle = 0;\n            let rotate = 0;\n            const ARC_LENGTH = 359;\n            const center = this.size / 2; // 圆心\n            const lineWidth = this.size / 10; // 圆环宽度\n            const duration = 1200; // 动画持续时间\n            const interval = this.speed; // 定时器间隔（大约 60 帧每秒）\n            // 使圆环过度更自然，不必运动到底\n            const ARC_MAX = 358;\n            let startTime = 0;\n            let foreward_end = 0; // 正传\n            let reversal_end = ARC_MAX; // 反转\n            function pogress_time() {\n                const currentTime = Date.now();\n                // 运动时间计算\n                const elapsedTime = currentTime - startTime;\n                const progress = elapsedTime / duration;\n                // 动画缓动\n                const easedProgress = easeInOutCubic(progress);\n                return easedProgress;\n            }\n            const draw = () => {\n                ctx.reset();\n                ctx.beginPath();\n                if (reversal_end == ARC_MAX) {\n                    foreward_end = Math.min(pogress_time() * ARC_LENGTH, ARC_LENGTH); // 限制 end 的最大值为 ARC_LENGTH\n                    if (foreward_end >= ARC_MAX) {\n                        reversal_end = 0;\n                        foreward_end = ARC_MAX;\n                        startTime = Date.now();\n                    }\n                }\n                if (foreward_end == ARC_MAX) {\n                    reversal_end = Math.min(pogress_time() * ARC_LENGTH, ARC_LENGTH);\n                    if (reversal_end >= ARC_MAX) {\n                        reversal_end = ARC_MAX;\n                        foreward_end = 0;\n                        startTime = Date.now();\n                    }\n                }\n                ctx.arc(center, center, center - lineWidth, startAngle + rotate + (reversal_end * Math.PI / 180), startAngle + rotate + (foreward_end * Math.PI / 180));\n                ctx.lineWidth = lineWidth;\n                const fillColor = (this.color !== '' ? this.color : '#666').toString();\n                ctx.strokeStyle = fillColor;\n                ctx.stroke();\n                ctx.update();\n                rotate += 0.05; // 旋转速度\n            };\n            this.timer = setInterval(() => { return draw(); }, interval);\n        }\n    }\n});\n//# sourceMappingURL=/Users/gaoruicheng/Documents/DcloudProject/uniapp-bugs/uniapp-bugs-main/singlePage/uniapp-hello-x/uni_modules/uni-loading/components/uni-loading/loading-circle.uvue?vue&type=script&lang.uts.js.map","references":["/Users/gaoruicheng/Documents/DcloudProject/uniapp-bugs/uniapp-bugs-main/singlePage/uniapp-hello-x/uni_modules/uni-loading/components/uni-loading/util.uts"],"uniExtApis":[],"map":"{\"version\":3,\"file\":\"loading-circle.uvue?vue&type=script&lang.uts.js\",\"sourceRoot\":\"\",\"sources\":[\"loading-circle.uvue?vue&type=script&lang.uts\"],\"names\":[],\"mappings\":\"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\"}"}
