{"code":"import { defineComponent } from \"vue\";\nimport tab1 from './custom-tab-bar-tab1.uvue';\nimport tab2 from './custom-tab-bar-tab2.uvue';\nclass TabItem extends UTS.UTSType {\n    static get$UTSMetadata$() {\n        return {\n            kind: 2,\n            get fields() {\n                return {\n                    init: { type: Boolean, optional: false },\n                    preload: { type: Boolean, optional: false }\n                };\n            }\n        };\n    }\n    constructor(options, metadata = TabItem.get$UTSMetadata$(), isJSONParse = false) {\n        super();\n        this.__props__ = UTS.UTSType.initProps(options, metadata, isJSONParse);\n        this.init = this.__props__.init;\n        this.preload = this.__props__.preload;\n        delete this.__props__;\n    }\n}\nexport default defineComponent({\n    components: {\n        tab1,\n        tab2\n    },\n    data() {\n        return {\n            tabList: [\n                new TabItem({\n                    init: true,\n                    preload: false\n                }),\n                new TabItem({\n                    init: false,\n                    preload: false\n                }),\n            ],\n            selectedIndex: 0,\n            displayArrow: false,\n            lastTab1Top: 0,\n            tabViewHeight: 0\n        };\n    },\n    onLoad() {\n        uni.$on('tabchange', this.onTabPageEvent); //监听tab1页面发出的tabchange事件，触发到本页面的onTabPageEvent方法。为了判断tab1的scroll-view滚动距离\n    },\n    onReady() {\n        // this.setSelectedIndex(0)\n        this.tabViewHeight = this.$refs[\"tabview\"].getBoundingClientRect().height;\n    },\n    onUnload() {\n        uni.$off('tabchange', this.onTabPageEvent);\n    },\n    methods: {\n        onTabClick(index) {\n            if (this.selectedIndex == index && index == 0 && this.displayArrow == true) { //首页当tab按钮变成向上时，点向上就滚动到顶\n                // uni.__log__('log','at pages/template/custom-tab-bar/custom-tab-bar.uvue:86',\"11\");\n                this.displayArrow = false;\n                this.$refs[\"tab1\"].$callMethod('scrollTop', 0);\n                this.lastTab1Top = 0; //Todo: 临时解决android平台scroll-view在某些情况未触发onscroll事件的bug\n            }\n            else if (index != 0) { //不在首页时，把箭头变成图标\n                // uni.__log__('log','at pages/template/custom-tab-bar/custom-tab-bar.uvue:92',\"22\");\n                this.displayArrow = false;\n            }\n            else if (index == 0 && this.selectedIndex != 0) { //从其他tab切回首页时，检查是否需要把图标变箭头\n                // uni.__log__('log','at pages/template/custom-tab-bar/custom-tab-bar.uvue:96',\"33\",this.lastTab1Top, this.tabViewHeight);\n                this.displayArrow = this.lastTab1Top > this.tabViewHeight;\n            }\n            this.setSelectedIndex(index);\n            // uni.__log__('log','at pages/template/custom-tab-bar/custom-tab-bar.uvue:100','index: ',index);\n            // uni.__log__('log','at pages/template/custom-tab-bar/custom-tab-bar.uvue:101','this.selectedIndex: ',this.selectedIndex);\n            // uni.__log__('log','at pages/template/custom-tab-bar/custom-tab-bar.uvue:102','this.displayArrow: ',this.displayArrow);\n            // uni.__log__('log','at pages/template/custom-tab-bar/custom-tab-bar.uvue:103','this.lastTab1Top: ',this.lastTab1Top);\n        },\n        onTabPageEvent(top) {\n            // uni.__log__('log','at pages/template/custom-tab-bar/custom-tab-bar.uvue:106','top: ',top);\n            this.displayArrow = top > this.tabViewHeight; //滚动1屏后，就把第一个tab的图标从首页变成向上箭头\n            this.lastTab1Top = top;\n        },\n        setSelectedIndex(index) {\n            if (this.selectedIndex === index) {\n                return null;\n            }\n            if (!this.tabList[index].init) {\n                this.tabList[index].init = true;\n            }\n            this.selectedIndex = index;\n        },\n        onPlusClick() {\n            uni.showModal({\n                title: \"提示\",\n                content: \"你点击了 +\",\n                showCancel: false\n            });\n        }\n    }\n});\n//# sourceMappingURL=/Users/gaoruicheng/Documents/DcloudProject/uniapp-bugs/uniapp-bugs-main/singlePage/uniapp-hello-x/pages/template/custom-tab-bar/custom-tab-bar.uvue?vue&type=script&lang.uts.js.map","references":["/Users/gaoruicheng/Documents/DcloudProject/uniapp-bugs/uniapp-bugs-main/singlePage/uniapp-hello-x/pages/template/custom-tab-bar/custom-tab-bar-tab1.uvue.ts","/Users/gaoruicheng/Documents/DcloudProject/uniapp-bugs/uniapp-bugs-main/singlePage/uniapp-hello-x/pages/template/custom-tab-bar/custom-tab-bar-tab2.uvue.ts"],"uniExtApis":["uni.$on","uni.$off","uni.showModal"],"map":"{\"version\":3,\"file\":\"custom-tab-bar.uvue?vue&type=script&lang.uts.js\",\"sourceRoot\":\"\",\"sources\":[\"custom-tab-bar.uvue?vue&type=script&lang.uts\"],\"names\":[],\"mappings\":\";AACE,OAAO,IAAI,MAAM,4BAA4B,CAAC;AAC9C,OAAO,IAAI,MAAM,4BAA4B,CAAC;MAEzC,OAAO;;;;;;;;;;;;;;;;;;;;AAKZ,+BAAe;IACb,UAAU,EAAE;QACV,IAAI;QACJ,IAAI;KACL;IACD,IAAI;QACF,OAAO;YACL,OAAO,EAAE;4BACP;oBACE,IAAI,EAAE,IAAI;oBACV,OAAO,EAAE,KAAK;iBACf;4BACD;oBACE,IAAI,EAAE,KAAK;oBACX,OAAO,EAAE,KAAK;iBACf;aACW;YACd,aAAa,EAAE,CAAC;YAChB,YAAY,EAAE,KAAK;YACnB,WAAW,EAAC,CAAC;YACb,aAAa,EAAE,CAAC;SACjB,CAAA;IACH,CAAC;IACD,MAAM;QACJ,GAAG,CAAC,GAAG,CAAC,WAAW,EAAE,IAAI,CAAC,cAAc,CAAC,CAAA,CAAC,yEAAyE;IACrH,CAAC;IACD,OAAO;QACL,2BAA2B;QAC3B,IAAI,CAAC,aAAa,GAAI,IAAI,CAAC,KAAK,CAAC,SAAS,CAAgB,CAAC,qBAAqB,EAAE,CAAC,MAAM,CAAA;IAC3F,CAAC;IACD,QAAQ;QACN,GAAG,CAAC,IAAI,CAAC,WAAW,EAAE,IAAI,CAAC,cAAc,CAAC,CAAA;IAC5C,CAAC;IACD,OAAO,EAAE;QACP,UAAU,CAAC,KAAc;YACvB,IAAI,IAAI,CAAC,aAAa,IAAI,KAAK,IAAI,KAAK,IAAI,CAAC,IAAI,IAAI,CAAC,YAAY,IAAI,IAAI,EAAE,EAAE,wBAAwB;gBACpG,qFAAqF;gBACrF,IAAI,CAAC,YAAY,GAAG,KAAK,CAAC;gBACzB,IAAI,CAAC,KAAK,CAAC,MAAM,CAA8B,CAAC,WAAW,CAAC,WAAW,EAAE,CAAC,CAAC,CAAA;gBAC5E,IAAI,CAAC,WAAW,GAAG,CAAC,CAAC,CAAA,sDAAsD;aAC5E;iBACI,IAAI,KAAK,IAAG,CAAC,EAAC,EAAE,eAAe;gBAClC,qFAAqF;gBACrF,IAAI,CAAC,YAAY,GAAG,KAAK,CAAA;aAC1B;iBACI,IAAI,KAAK,IAAI,CAAC,IAAI,IAAI,CAAC,aAAa,IAAG,CAAC,EAAC,EAAE,0BAA0B;gBACxE,0HAA0H;gBAC1H,IAAI,CAAC,YAAY,GAAG,IAAI,CAAC,WAAW,GAAG,IAAI,CAAC,aAAa,CAAA;aAC1D;YACD,IAAI,CAAC,gBAAgB,CAAC,KAAK,CAAC,CAAC;YAC7B,iGAAiG;YACjG,2HAA2H;YAC3H,yHAAyH;YACzH,uHAAuH;QACzH,CAAC;QACD,cAAc,CAAC,GAAY;YACzB,6FAA6F;YAC7F,IAAI,CAAC,YAAY,GAAG,GAAG,GAAG,IAAI,CAAC,aAAa,CAAA,CAAC,4BAA4B;YACzE,IAAI,CAAC,WAAW,GAAG,GAAG,CAAA;QACxB,CAAC;QACD,gBAAgB,CAAC,KAAc;YAC7B,IAAI,IAAI,CAAC,aAAa,KAAK,KAAK,EAAE;gBAChC,YAAM;aACP;YACD,IAAI,CAAC,IAAI,CAAC,OAAO,CAAC,KAAK,CAAC,CAAC,IAAI,EAAE;gBAC7B,IAAI,CAAC,OAAO,CAAC,KAAK,CAAC,CAAC,IAAI,GAAG,IAAI,CAAA;aAChC;YACD,IAAI,CAAC,aAAa,GAAG,KAAK,CAAA;QAC5B,CAAC;QACD,WAAW;YACT,GAAG,CAAC,SAAS,CAAC;gBACZ,KAAK,EAAE,IAAI;gBACX,OAAO,EAAE,QAAQ;gBACjB,UAAU,EAAE,KAAK;aAClB,CAAC,CAAA;QACJ,CAAC;KACF;CACF,EAAA\"}"}
