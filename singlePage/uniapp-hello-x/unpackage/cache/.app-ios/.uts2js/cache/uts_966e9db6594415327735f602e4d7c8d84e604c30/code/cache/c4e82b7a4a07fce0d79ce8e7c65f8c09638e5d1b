{"code":"import { defineComponent } from \"vue\";\nconst SERVER_URL = \"https://unidemo.dcloud.net.cn/plugin/uniappx-plugin-list\";\nconst PAGE_SIZE = 10; // 最大值 10\nclass ListItem extends UTS.UTSType {\n    static get$UTSMetadata$() {\n        return {\n            kind: 2,\n            get fields() {\n                return {\n                    plugin_id: { type: Number, optional: false },\n                    plugin_img_link: { type: String, optional: false },\n                    plugin_name: { type: String, optional: false },\n                    plugin_intro: { type: String, optional: false },\n                    score: { type: Number, optional: false },\n                    tags: { type: \"Unknown\", optional: false },\n                    update_date: { type: String, optional: false },\n                    author_name: { type: String, optional: false }\n                };\n            }\n        };\n    }\n    constructor(options, metadata = ListItem.get$UTSMetadata$(), isJSONParse = false) {\n        super();\n        this.__props__ = UTS.UTSType.initProps(options, metadata, isJSONParse);\n        this.plugin_id = this.__props__.plugin_id;\n        this.plugin_img_link = this.__props__.plugin_img_link;\n        this.plugin_name = this.__props__.plugin_name;\n        this.plugin_intro = this.__props__.plugin_intro;\n        this.score = this.__props__.score;\n        this.tags = this.__props__.tags;\n        this.update_date = this.__props__.update_date;\n        this.author_name = this.__props__.author_name;\n        delete this.__props__;\n    }\n}\nclass ResponseDataType extends UTS.UTSType {\n    static get$UTSMetadata$() {\n        return {\n            kind: 2,\n            get fields() {\n                return {\n                    code: { type: Number, optional: false },\n                    data: { type: UTS.UTSType.withGenerics(Array, [ListItem]), optional: false }\n                };\n            }\n        };\n    }\n    constructor(options, metadata = ResponseDataType.get$UTSMetadata$(), isJSONParse = false) {\n        super();\n        this.__props__ = UTS.UTSType.initProps(options, metadata, isJSONParse);\n        this.code = this.__props__.code;\n        this.data = this.__props__.data;\n        delete this.__props__;\n    }\n}\nexport default defineComponent({\n    props: {\n        type: {\n            type: String,\n            default: ''\n        },\n        preload: {\n            type: Boolean,\n            default: false\n        },\n        id: {\n            type: String,\n            default: ''\n        }\n    },\n    data() {\n        return {\n            loading: false,\n            dataList: [],\n            isEnded: false,\n            loadingError: '',\n            currentPage: 1\n        };\n    },\n    computed: {\n        loadingText() {\n            if (this.loading) {\n                return \"加载中...\";\n            }\n            else if (this.isEnded) {\n                return \"没有更多了\";\n            }\n            else if (this.loadingError.length > 0) {\n                return this.loadingError;\n            }\n            else {\n                return \"\";\n            }\n        }\n    },\n    created() {\n        if (this.preload) {\n            this.loadData(null);\n        }\n    },\n    methods: {\n        refreshData(loadComplete = null) {\n            this.dataList.length = 0;\n            this.currentPage = 1;\n            this.loadData(loadComplete);\n        },\n        loadData(loadComplete = null) {\n            if (this.loading || this.isEnded) {\n                return null;\n            }\n            this.loading = true;\n            uni.request({\n                url: SERVER_URL,\n                data: {\n                    type: this.type,\n                    page: this.currentPage,\n                    page_size: PAGE_SIZE\n                },\n                success: (res) => {\n                    const responseData = res.data;\n                    if (responseData == null) {\n                        return null;\n                    }\n                    this.dataList.push(...responseData.data);\n                    if (responseData.data.length == 0) {\n                        this.isEnded = true;\n                    }\n                    else {\n                        this.currentPage++;\n                    }\n                },\n                fail: (err) => {\n                    this.loadingError = err.errMsg;\n                },\n                complete: () => {\n                    this.loading = false;\n                    if (loadComplete != null) {\n                        loadComplete();\n                    }\n                }\n            }, ResponseDataType);\n        },\n        // score 0 ~ 50\n        convertToStarUnicode(score) {\n            const fill_code = '\\ue879';\n            const half_code = '\\ue87a';\n            const null_code = '\\ue87b';\n            const fillStarCount = parseInt(score / 10 % 10 + '');\n            const halfStarCount = score % 10 >= 5 ? 1 : 0;\n            const nullStarCount = 5 - fillStarCount - halfStarCount;\n            let result = '';\n            if (fillStarCount > 0) {\n                result += fill_code.repeat(fillStarCount);\n            }\n            if (halfStarCount > 0) {\n                result += half_code.repeat(halfStarCount);\n            }\n            if (nullStarCount > 0) {\n                result += null_code.repeat(nullStarCount);\n            }\n            return result;\n        }\n    }\n});\n//# sourceMappingURL=/Users/gaoruicheng/Documents/DcloudProject/uniapp-bugs/uniapp-bugs-main/singlePage/uniapp-hello-x/pages/template/long-list/long-list-page.uvue?vue&type=script&lang.uts.js.map","references":[],"uniExtApis":["uni.request"],"map":"{\"version\":3,\"file\":\"long-list-page.uvue?vue&type=script&lang.uts.js\",\"sourceRoot\":\"\",\"sources\":[\"long-list-page.uvue?vue&type=script&lang.uts\"],\"names\":[],\"mappings\":\"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\"}"}
