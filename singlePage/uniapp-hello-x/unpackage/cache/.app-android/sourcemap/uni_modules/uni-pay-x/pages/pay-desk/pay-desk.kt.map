{"version":3,"sources":["uni_modules/uni-pay-x/pages/pay-desk/pay-desk.uvue","pages/API/navigator/navigator.uvue?type=page","uni_modules/uni-pay-x/pages/pay-desk/pay-desk.uvue?type=page"],"sourcesContent":["<template>\n\t<!-- 自定义收银台页面模式 -->\n\t<view class=\"uni-pay\">\n\t\t<view class=\"mobile-pay-popup\">\n\t\t\t<view class=\"mobile-pay-popup-amount-box\">\n\t\t\t\t<view><text class=\"text\">待支付金额：</text></view>\n\t\t\t\t<view class=\"mobile-pay-popup-amount\"><text class=\"text\">{{ amountFormat(myOptions.getNumber('total_fee')) }}</text></view>\n\t\t\t</view>\n\t\t\t<view class=\"mobile-pay-popup-provider-list\">\n\t\t\t\t<view class=\"uni-list\">\n\n\t\t\t\t\t<view class=\"uni-list-item\" v-if=\"checkProvider('wxpay')\" @click=\"createOrderByProvider('wxpay')\">\n\t\t\t\t\t\t<view class=\"uni-list-item__container container--right\">\n\t\t\t\t\t\t\t<view class=\"uni-list-item__header\">\n\t\t\t\t\t\t\t\t<image :src=\"insideData.getJSON('images')!['wxpay']\" class=\"image\"></image>\n\t\t\t\t\t\t\t</view>\n\t\t\t\t\t\t\t<view class=\"uni-list-item__content uni-list-item__content--center\">\n\t\t\t\t\t\t\t\t<text class=\"text\">微信支付</text>\n\t\t\t\t\t\t\t</view>\n\t\t\t\t\t\t</view>\n\t\t\t\t\t\t<view class=\"arrowright\"></view>\n\t\t\t\t\t</view>\n\n\n\t\t\t\t\t<view class=\"uni-list-item\" v-if=\"checkProvider('alipay')\" @click=\"createOrderByProvider('alipay')\">\n\t\t\t\t\t\t<view class=\"uni-list-item__container container--right\">\n\t\t\t\t\t\t\t<view class=\"uni-list-item__header\">\n\t\t\t\t\t\t\t\t<image :src=\"insideData.getJSON('images')!['alipay']\" class=\"image\"></image>\n\t\t\t\t\t\t\t</view>\n\t\t\t\t\t\t\t<view class=\"uni-list-item__content uni-list-item__content--center\">\n\t\t\t\t\t\t\t\t<text class=\"text\">支付宝</text>\n\t\t\t\t\t\t\t</view>\n\t\t\t\t\t\t</view>\n\t\t\t\t\t\t<view class=\"arrowright\"></view>\n\t\t\t\t\t</view>\n\n\t\t\t\t</view>\n\t\t\t</view>\n\t\t</view>\n\t\t<!-- 挂载支付组件 -->\n\t\t<uni-pay ref=\"payRef\" height=\"900rpx\" :to-success-page=\"false\" @mounted=\"onMounted\" @success=\"onSuccess\" @fail=\"onFail\" @cancel=\"onCancel\"></uni-pay>\n\t</view>\n</template>\n\n<script>\n\timport { objectAssign } from \"../../js_sdk/js_sdk\"\n\texport default {\n\t\tdata() {\n\t\t\treturn {\n\t\t\t\tmyOptions: {\n\t\t\t\t\ttotal_fee: \"\",\n\t\t\t\t} as UTSJSONObject,\n\t\t\t\tinsideData: {\n\t\t\t\t\tcurrentProviders: [] as Array<string>,\n\t\t\t\t\timages: {\n\t\t\t\t\t\talipay: \"\",\n\t\t\t\t\t\twxpay: \"\"\n\t\t\t\t\t} as UTSJSONObject\n\t\t\t\t} as UTSJSONObject, // uni-pay组件mounted事件获得的数据\n\t\t\t\tadpid: \"\", // 广告id\n\t\t\t\treturn_url: \"\", // 支付成功后点击查看订单跳转的订单详情页面地址\n\t\t\t\tmain_color: \"\", // 支付成功页面的主色调\n\t\t\t}\n\t\t},\n\t\t// 监听 - 页面每次【加载时】执行(如：前进)\n\t\tonLoad(options) {\n\t\t\tlet optionsStr = options['options'] as string | null;\n\t\t\tif (optionsStr != null && optionsStr != \"\") {\n\t\t\t\tlet newOptions = JSON.parse(decodeURI(optionsStr)!) as UTSJSONObject;\n\t\t\t\tthis.myOptions = newOptions as UTSJSONObject;\n\t\t\t}\n\t\t\tconsole.log('myOptions: ', this.myOptions)\n\t\t},\n\t\t// 监听 - 页面【首次渲染完成时】执行。注意如果渲染速度快，会在页面进入动画完成前触发\n\t\tonReady() { },\n\t\t// 监听 - 页面每次【显示时】执行(如：前进和返回) (页面每次出现在屏幕上都触发，包括从下级页面点返回露出当前页面)\n\t\tonShow() { },\n\t\t// 监听 - 页面每次【隐藏时】执行(如：返回)\n\t\tonHide() { },\n\t\t// 函数\n\t\tmethods: {\n\t\t\t// 监听 - 支付组件加载完毕事件\n\t\t\tonMounted(insideData : UTSJSONObject) {\n\t\t\t\tthis.insideData['currentProviders'] = insideData.getArray('currentProviders') as Array<string>;\n\t\t\t\tthis.insideData['images'] = insideData.getJSON('images') as UTSJSONObject;\n\t\t\t},\n\t\t\t// 发起支付\n\t\t\tcreateOrder(data : UTSJSONObject) {\n\t\t\t\tthis.myOptions = objectAssign(this.myOptions, data);\n\t\t\t\tconst payInstance = this.$refs[\"payRef\"] as UniPayComponentPublicInstance;\n\t\t\t\tpayInstance.createOrder(this.myOptions);\n\t\t\t},\n\t\t\t// 根据provider发起支付\n\t\t\tcreateOrderByProvider(provider : string) {\n\t\t\t\tthis.createOrder({\n\t\t\t\t\tprovider\n\t\t\t\t})\n\t\t\t},\n\t\t\t// 监听事件 - 支付成功\n\t\t\tonSuccess(res : UTSJSONObject) {\n\t\t\t\tlet out_trade_no = res['out_trade_no'] as string;\n\t\t\t\tlet pay_order = res.getJSON('pay_order') as UTSJSONObject;\n\t\t\t\tlet order_no = pay_order['order_no'] as string;\n\t\t\t\t//let pay_date = pay_order['pay_date'] as string;\n\t\t\t\tlet total_fee = pay_order.getNumber('total_fee');\n\t\t\t\tif (total_fee == null) {\n\t\t\t\t\ttotal_fee = 0;\n\t\t\t\t}\n\t\t\t\tlet return_url = this.return_url as string;\n\t\t\t\tlet adpid = this.adpid as string;\n\t\t\t\tlet main_color = this.main_color as string;\n\n\t\t\t\tconsole.log('success: ', res);\n\t\t\t\tlet user_order_success = res.getBoolean('user_order_success');\n\t\t\t\tif (user_order_success != null && user_order_success != true) {\n\t\t\t\t\t// 代表用户已付款，且你自己写的回调成功并正确执行了\n\t\t\t\t\tuni.redirectTo({\n\t\t\t\t\t\turl: `/uni_modules/uni-pay-x/pages/success/success?out_trade_no=${out_trade_no}&order_no=${order_no}&total_fee=${total_fee}&adpid=${adpid}&return_url=${return_url}&main_color=${main_color}`\n\t\t\t\t\t});\n\t\t\t\t} else {\n\t\t\t\t\t// 代表用户已付款，但你自己写的回调执行失败（通常是因为你的回调代码有问题）\n\n\t\t\t\t}\n\t\t\t},\n\t\t\t// 监听事件 - 支付失败\n\t\t\tonFail(err : RequestPaymentFail) {\n\t\t\t\tconsole.log('fail: ', err)\n\n\t\t\t},\n\t\t\t// 监听事件 - 取消支付\n\t\t\tonCancel(err : RequestPaymentFail) {\n\t\t\t\tconsole.log('cancel: ', err)\n\n\t\t\t},\n\t\t\tamountFormat(totalFee : number | null) :string{\n\t\t\t\tif (totalFee == null) {\n\t\t\t\t\treturn \"0\";\n\t\t\t\t} else {\n\t\t\t\t\treturn (totalFee / 100).toFixed(2)\n\t\t\t\t} \n\t\t\t},\n\t\t\t// 检测provider\n\t\t\tcheckProvider(provider : string) : boolean {\n\t\t\t\tlet currentProviders = this.insideData.getArray<string>('currentProviders');\n\t\t\t\treturn currentProviders != null && currentProviders.indexOf(provider) > -1 ? true : false;\n\t\t\t}\n\t\t},\n\t\t// 监听器\n\t\twatch: {\n\n\t\t},\n\t\t// 计算属性\n\t\tcomputed: {\n\n\t\t}\n\t}\n</script>\n<style lang=\"scss\" scoped>\n\t.uni-pay{\n\t\tflex: 1;\n\t\tdisplay: flex;\n\t\tflex-direction: column;\n\t\tbackground-color: #f3f3f3;\n\t}\n\t.mobile-pay-popup {\n\t\tflex: 1;\n\t\t.mobile-pay-popup-amount-box {\n\t\t\tbackground-color: #ffffff;\n\t\t\tpadding: 30rpx;\n\n\t\t\t.mobile-pay-popup-amount {\n\t\t\t\tmargin-top: 20rpx;\n\n\t\t\t\t.text {\n\t\t\t\t\tcolor: #e43d33;\n\t\t\t\t\tfont-size: 60rpx;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t.mobile-pay-popup-provider-list {\n\t\t\tbackground-color: #ffffff;\n\t\t\tmargin-top: 20rpx;\n\n\t\t\t.uni-list {\n\t\t\t\tdisplay: flex;\n\t\t\t\tbackground-color: #fff;\n\t\t\t\tposition: relative;\n\t\t\t\tflex-direction: column;\n\n\t\t\t\t.uni-list-item {\n\t\t\t\t\tdisplay: flex;\n\t\t\t\t\tposition: relative;\n\t\t\t\t\tjustify-content: space-between;\n\t\t\t\t\talign-items: center;\n\t\t\t\t\tbackground-color: #fff;\n\t\t\t\t\tflex-direction: row;\n\t\t\t\t\tborder-bottom: 2rpx solid #f8f8f8;\n\t\t\t\t\t\n\n\n\n\t\t\t\t\t\n\t\t\t\t\t&:hover {\n\t\t\t\t\t\tbackground-color: #f1f1f1;\n\t\t\t\t\t}\n\n\t\t\t\t\t.uni-list-item__container {\n\t\t\t\t\t\tposition: relative;\n\t\t\t\t\t\tdisplay: flex;\n\t\t\t\t\t\tflex-direction: row;\n\t\t\t\t\t\tpadding: 12px 15px;\n\t\t\t\t\t\tpadding-left: 15px;\n\t\t\t\t\t\tflex: 1;\n\t\t\t\t\t\toverflow: hidden;\n\n\t\t\t\t\t\t.uni-list-item__header {\n\t\t\t\t\t\t\tdisplay: flex;\n\t\t\t\t\t\t\tflex-direction: row;\n\t\t\t\t\t\t\talign-items: center;\n\n\t\t\t\t\t\t\t.image {\n\t\t\t\t\t\t\t\twidth: 52rpx;\n\t\t\t\t\t\t\t\theight: 52rpx;\n\t\t\t\t\t\t\t\tmargin-right: 18rpx;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\t.container--right {\n\t\t\t\t\t\tpadding-right: 0;\n\t\t\t\t\t}\n\n\t\t\t\t\t.uni-list-item__content {\n\t\t\t\t\t\tdisplay: flex;\n\t\t\t\t\t\tpadding-right: 8px;\n\t\t\t\t\t\tflex: 1;\n\t\t\t\t\t\tflex-direction: column;\n\t\t\t\t\t\tjustify-content: space-between;\n\t\t\t\t\t\toverflow: hidden;\n\n\t\t\t\t\t\t.text {\n\t\t\t\t\t\t\tcolor: #3b4144;\n\t\t\t\t\t\t\tfont-size: 28rpx;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\t.uni-list-item__content--center {\n\t\t\t\t\t\tjustify-content: center;\n\t\t\t\t\t}\n\n\t\t\t\t\t.arrowright {\n\t\t\t\t\t\tborder-top: 2rpx solid #bbbbbb;\n\t\t\t\t\t\tborder-right: 2rpx solid #bbbbbb;\n\t\t\t\t\t\twidth: 16rpx;\n\t\t\t\t\t\theight: 16rpx;\n\t\t\t\t\t\tmargin-right: 30rpx;\n\t\t\t\t\t\ttransform: rotate(45deg);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n</style>",null,null],"names":[],"mappings":"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"}