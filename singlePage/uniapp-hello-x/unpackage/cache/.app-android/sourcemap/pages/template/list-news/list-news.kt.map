{"version":3,"sources":["pages/template/list-news/list-news.uvue","pages/ask/index/index.uvue?type=page","pages/API/request/request.uvue?type=page","uni_modules/uni-upgrade-center-app/components/uni-upgrade-center-app/uni-upgrade-center-app.uvue","pages/template/list-news/list-news.uvue?type=page"],"sourcesContent":["<template>\r\n  <list-view style=\"flex: 1;\" refresher-enabled=true @refresherrefresh=\"onRefresherrefresh\"\r\n    :refresher-triggered=\"refresherTriggered\" enable-back-to-top=\"true\">\r\n    <list-item class=\"banner\" @click=\"bannerClick(banner)\" type=1>\r\n      <image class=\"banner-img\" :src=\"banner.cover\"></image>\r\n      <text class=\"banner-title\">{{ banner.title }}</text>\r\n    </list-item>\r\n    <sticky-header>\r\n      <view\r\n        style=\"width: 100%;height:44px;background-color: #f5f5f5;flex-direction: row;justify-content:center;align-items:center;\">\r\n        <text v-for=\"(name,index) in th_item\" @click=\"clickTH(index)\" style=\"margin-right: 20px;\">\r\n          {{name}}\r\n        </text>\r\n      </view>\r\n    </sticky-header>\r\n    <list-item v-for=\"(value, index) in listData\" :key=\"index\" type=2>\r\n      <view class=\"uni-list-cell\" hover-class=\"uni-list-cell-hover\" @click=\"goDetail(value)\">\r\n        <view class=\"uni-media-list\">\r\n          <image class=\"uni-media-list-logo\" :src=\"value.cover\"></image>\r\n          <view class=\"uni-media-list-body\">\r\n            <text class=\"uni-media-list-text-top\">{{ value.title }}</text>\r\n            <view class=\"uni-media-list-text-bottom\">\r\n              <text class=\"uni-media-list-text\">{{ value.author_name }}</text>\r\n              <text class=\"uni-media-list-text\">{{ value.published_at }}</text>\r\n            </view>\r\n          </view>\r\n        </view>\r\n      </view>\r\n    </list-item>\r\n  </list-view>\r\n</template>\r\n\r\n<script>\r\n  type Banner = {\r\n    cover : string | null,\r\n    title : string | null,\r\n    post_id : string | null\r\n  }\r\n  type Item = {\r\n    author_name : string,\r\n    cover : string,\r\n    id : number,\r\n    post_id : string,\r\n    published_at : string,\r\n    title : string\r\n  }\r\n\r\n  export default {\r\n    data() {\r\n      return {\r\n        th_item: [\"排序\", \"筛选\"],\r\n        refresherTriggered: false,\r\n        banner: {} as Banner,\r\n        listData: [] as Item[],\r\n        last_id: '',\r\n      };\r\n    },\r\n    onLoad() {\r\n      this.getBanner();\r\n      this.getList();\r\n    },\r\n    onUnload() {\r\n    },\r\n    methods: {\r\n      getBanner() {\r\n        let data = {\r\n          column: 'id,post_id,title,author_name,cover,published_at' //需要的字段名\r\n        };\r\n        uni.request<Banner>({\r\n          url: 'https://unidemo.dcloud.net.cn/api/banner/36kr',\r\n          data: data,\r\n          success: data => {\r\n            this.refresherTriggered = false\r\n            if (data.statusCode == 200) {\r\n              const result = data.data\r\n              if (result != null) {\r\n                this.banner = result;\r\n              }\r\n            }\r\n          },\r\n          fail: (e) => {\r\n            console.log('fail', e);\r\n          }\r\n        });\r\n      },\r\n      getList() {\r\n        let url = \"https://unidemo.dcloud.net.cn/api/news?column=id,post_id,title,author_name,cover,published_at\";\r\n        /* if (this.last_id != \"\") {\r\n          const minId = parseInt((this.last_id))\r\n          const time = new Date().getTime() + '';\r\n          const pageSize = 10;\r\n          url = url + \"&minId=\" + minId + \"&time=\" + time + \"&pageSize=\" + pageSize;\r\n        } */\r\n\r\n        uni.request<Item[]>({\r\n          url: url,\r\n          method: \"GET\",\r\n          success: (res) => {\r\n            if (res.statusCode == 200) {\r\n              console.log(res);\r\n              const result = res.data\r\n              if (result != null) {\r\n                this.listData = result //因本接口没有更多分页数据，所以重新赋值。正常有分页的列表应该如下面push方式增加数组项\r\n                // this.listData.push(...result)\r\n                // this.last_id = this.listData[0].id + \"\";\r\n              }\r\n              this.refresherTriggered = false;\r\n            }\r\n          },\r\n          fail: (res) => {\r\n            console.log('fail', res);\r\n            this.refresherTriggered = false\r\n          }\r\n        });\r\n      },\r\n      goDetail(e : Item) {\r\n        const detail = e;\r\n        const post_id = detail.post_id;\r\n        const cover = detail.cover;\r\n        const title = detail.title;\r\n        uni.navigateTo({\r\n          url: '/pages/template/list-news/detail/detail?post_id=' + post_id + \"&cover=\" + cover + \"&title=\" + title\r\n        });\r\n      },\r\n      bannerClick(e : Banner) {\r\n        const detail = e;\r\n        const post_id = detail.post_id;\r\n        const cover = detail.cover;\r\n        const title = detail.title;\r\n        uni.navigateTo({\r\n          url: '/pages/template/list-news/detail/detail?post_id=' + post_id + \"&cover=\" + cover + \"&title=\" + title\r\n        });\r\n      },\r\n      clickTH(index : number) {\r\n        uni.showModal({\r\n          content: \"点击表头项：\" + index,\r\n          showCancel: false\r\n        });\r\n      },\r\n      onRefresherrefresh() {\r\n        this.refresherTriggered = true\r\n        this.getBanner();\r\n        this.getList();\r\n      }\r\n    }\r\n  };\r\n</script>\r\n\r\n<style>\r\n  .banner {\r\n    height: 180px;\r\n    overflow: hidden;\r\n    position: relative;\r\n    background-color: #ccc;\r\n  }\r\n\r\n  .banner-img {\r\n    width: 100%;\r\n  }\r\n\r\n  .banner-title {\r\n    max-height: 42px;\r\n    overflow: hidden;\r\n    position: absolute;\r\n    left: 15px;\r\n    bottom: 15px;\r\n    width: 90%;\r\n    font-size: 16px;\r\n    font-weight: 400;\r\n    line-height: 21px;\r\n    color: white;\r\n  }\r\n\r\n  .uni-media-list {\r\n    padding: 11px 15px;\r\n    box-sizing: border-box;\r\n    display: flex;\r\n    width: 100%;\r\n    flex-direction: row;\r\n  }\r\n\r\n  .uni-media-list-logo {\r\n    width: 90px;\r\n    height: 70px;\r\n  }\r\n\r\n  .uni-media-list-body {\r\n    flex: 1;\r\n    padding-left: 7px;\r\n    justify-content: space-around;\r\n  }\r\n\r\n  .uni-media-list-text-top {\r\n    /* height: 37px; */\r\n    font-size: 14px;\r\n    lines: 2;\r\n    overflow: hidden;\r\n  }\r\n\r\n  .uni-media-list-text-bottom {\r\n    display: flex;\r\n    flex-direction: row;\r\n    justify-content: space-between;\r\n  }\r\n\r\n  .uni-media-list-text {\r\n    color: #9D9D9F;\r\n    font-size: 13px;\r\n  }\r\n</style>\n",null,null,null,null],"names":[],"mappings":"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"}