{"version":3,"sources":["pages/API/download-file/download-file.uvue","uni_modules/uni-upgrade-center-app/components/uni-upgrade-center-app/uni-upgrade-center-app.uvue","pages/API/get-file-system-manager/get-file-system-manager.uvue?type=page","node-modules/@dcloudio/uni-components/lib-x/unicloud-db/unicloud-db.vue","pages/API/request/request.uvue?type=page","pages/API/download-file/download-file.uvue?type=page"],"sourcesContent":["<template>\n\n  <scroll-view style=\"flex: 1\">\n\n    <view>\n      <page-head :title=\"title\"></page-head>\n      <view>\n        <view v-if=\"imageSrc\">\n          <image class=\"img\" :src=\"imageSrc\" mode=\"aspectFit\" />\n        </view>\n        <view v-else style=\"margin: 10px;\">\n          <text class=\"uni-hello-text\">点击按钮下载服务端示例图片（下载网络文件到本地临时目录）</text>\n          <button type=\"primary\" @tap=\"downloadImage\">下载</button>\n        </view>\n      </view>\n    </view>\n\n  </scroll-view>\n\n</template>\n<script>\n\n\n  import {\n    testInovkeDownloadFile,\n    CommonOptions\n  } from '@/uni_modules/test-invoke-network-api'\n\n\n  export default {\n    data() {\n      return {\n        title: 'downloadFile',\n        imageSrc: '',\n        task: null as DownloadTask | null,\n        //自动化测试例专用\n        jest_result: false\n      }\n    },\n    onLoad() {\n    },\n    onUnload() {\n      // this.imageSrc = '';\n      uni.hideLoading();\n      this.task?.abort();\n    },\n    methods: {\n      downloadImage: function () {\n        uni.showLoading({\n          title: '下载中'\n        })\n        var self = this\n        this.task = uni.downloadFile({\n          url: \"https://qiniu-web-assets.dcloud.net.cn/unidoc/zh/uni-app.png\",\n          success: (res) => {\n            console.log('downloadFile success, res is', res.tempFilePath)\n            self.imageSrc = res.tempFilePath;\n            uni.hideLoading();\n          },\n          fail: (err) => {\n            console.log('downloadFile fail, err is:', err)\n            uni.hideLoading();\n          }\n        });\n        this.task?.onProgressUpdate((update) => {\n          console.log(\"progress : \", update.progress);\n        })\n      },\n      //自动化测试例专用\n      jest_downloadFile() {\n        uni.downloadFile({\n          url: \"https://qiniu-web-assets.dcloud.net.cn/unidoc/zh/uni-app.png\",\n          success: () => {\n            this.jest_result = true\n          },\n          fail: () => {\n            this.jest_result = false\n          }\n        });\n      },\n\n      jest_downloadFile_with_uni_env() {\n        uni.downloadFile({\n          url: \"https://qiniu-web-assets.dcloud.net.cn/unidoc/zh/uni-app.png\",\n          filePath: `${uni.env.CACHE_PATH}/a/b/`,\n          success: () => {\n            this.jest_result = true\n          },\n          fail: () => {\n            this.jest_result = false\n          }\n        });\n      },\n\n      jest_set_cookie(){\n        uni.request({\n          url: \"https://request.dcloud.net.cn/api/http/header/setCookie\",\n          method: \"GET\",\n          timeout: 6000,\n          sslVerify: false,\n          withCredentials: true,\n          firstIpv4: false,\n          success: () => {\n            this.jest_cookie_download(true)\n          },\n          fail: () => {\n            this.jest_result = false;\n          },\n        });\n      },\n\n      jest_delete_cookie(){\n        uni.request({\n          url: \"https://request.dcloud.net.cn/api/http/header/deleteCookie\",\n          method: \"GET\",\n          timeout: 6000,\n          sslVerify: false,\n          withCredentials: true,\n          firstIpv4: false,\n          success: () => {\n            this.jest_cookie_download(false)\n          },\n          fail: () => {\n            this.jest_result = false;\n          },\n        });\n      },\n      jest_cookie_download(needCookie: boolean){\n        uni.downloadFile({\n          url: \"https://request.dcloud.net.cn/api/http/header/download\",\n          success: () => {\n            this.jest_result = needCookie ? true : false;\n          },\n          fail: () => {\n            this.jest_result = needCookie ? false : true;\n          }\n        });\n      },\n      jest_uts_module_invoked(){\n\n        testInovkeDownloadFile({\n          success:(res: any)=>{\n            console.log(\"success :\", res);\n            this.jest_result = true\n          },\n          fail:(err: any)=>{\n            console.log(\"fail :\", err);\n            this.jest_result = false\n          }\n        } as CommonOptions)\n\n      },\n      jest_special_characters_download(){\n        uni.downloadFile({\n          url: \"https://web-ext-storage.dcloud.net.cn/hello-uni-app-x/1789834995055525889-你好%23你好.png\",\n          success: (res: DownloadFileSuccess) => {\n            this.jest_result = true;\n            console.log(\"res :\", res);\n          },\n          fail: () => {\n            this.jest_result = false;\n          }\n        });\n      }\n    }\n  }\n</script>\n\n<style>\n  .img {\n    margin: 0 auto;\n  }\n</style>\n",null,null,null,null,null],"names":[],"mappings":"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"}