{"version":3,"sources":["pages/component/web-view/web-view.uvue","pages/component/web-view/web-view.uvue?type=page","uni_modules/uni-upgrade-center-app/components/uni-upgrade-center-app/uni-upgrade-center-app.uvue"],"sourcesContent":["<template>\n  <scroll-view class=\"uni-flex-item\">\n    <web-view id=\"web-view\" class=\"uni-flex-item\" :src=\"src\" :webview-styles=\"webview_styles\"\n      :horizontalScrollBarAccess=\"horizontalScrollBarAccess\" :verticalScrollBarAccess=\"verticalScrollBarAccess\"\n      @message=\"message\" @error=\"error\" @loading=\"loading\" @load=\"load\" @download=\"download\">\n    </web-view>\n\n    <view class=\"uni-padding-wrap uni-common-mt\">\n      <view class=\"uni-btn-v\">\n        <input class=\"uni-input\" confirmType=\"go\" placeholder=\"输入网址跳转\" @confirm=\"confirm\" maxlength=\"-1\"/>\n      </view>\n      <view class=\"uni-row uni-btn-v\">\n        <button class=\"uni-flex-item\" type=\"primary\" @click=\"back\">后退</button>\n        <button class=\"margin-left-5 uni-flex-item\" type=\"primary\" @click=\"forward\">前进</button>\n      </view>\n      <view class=\"uni-row uni-btn-v\">\n        <button class=\"uni-flex-item\" type=\"primary\" @click=\"reload\">重新加载</button>\n        <button class=\"margin-left-5 uni-flex-item\" type=\"primary\" @click=\"stop\">停止加载</button>\n      </view>\n      <view class=\"uni-btn-v\">\n        <button type=\"primary\" @click=\"nativeToWeb\">原生和Web通信</button>\n      </view>\n\n      <view class=\"uni-row uni-btn-v\">\n        <view class=\"uni-row uni-flex-item align-items-center\">\n          <text>显示横向滚动条</text>\n          <switch :checked=\"true\" @change=\"changeHorizontalScrollBarAccess\"></switch>\n        </view>\n        <view class=\"uni-row uni-flex-item align-items-center\">\n          <text>显示竖向滚动条</text>\n          <switch :checked=\"true\" @change=\"changeVerticalScrollBarAccess\"></switch>\n        </view>\n      </view>\n\n    </view>\n\n  </scroll-view>\n</template>\n\n<script>\n  export default {\n    data() {\n      return {\n        src: 'https://www.dcloud.io',\n        webview_styles: {\n          progress: {\n            color: '#FF3333'\n          }\n        },\n        webviewContext: null as WebviewContext | null,\n        loadError: false,\n        horizontalScrollBarAccess: true,\n        verticalScrollBarAccess: true,\n        // 自动化测试\n        autoTest: false,\n        eventLoading: null as UTSJSONObject | null,\n        eventLoad: null as UTSJSONObject | null,\n        eventError: null as UTSJSONObject | null\n      }\n    },\n    onReady() {\n\n      // TODO web 实现createWebviewContext\n      this.webviewContext = uni.createWebviewContext('web-view', this)\n\n    },\n    methods: {\n      back() {\n        this.webviewContext?.back();\n      },\n      forward() {\n        this.webviewContext?.forward();\n      },\n      reload() {\n        this.webviewContext?.reload();\n      },\n      stop() {\n        this.webviewContext?.stop();\n      },\n      nativeToWeb() {\n        this.webviewContext?.evalJS(\"alert('hello uni-app x')\");\n      },\n      message(event : UniWebViewMessageEvent) {\n        console.log(JSON.stringify(event.detail));\n      },\n      error(event : UniWebViewErrorEvent) {\n        this.loadError = true\n        console.log(JSON.stringify(event.detail));\n        if (this.autoTest) {\n          this.eventError = {\n            \"tagName\": event.target?.tagName,\n            \"type\": event.type,\n            \"errCode\": event.detail.errCode,\n            \"errMsg\": event.detail.errMsg,\n            \"url\": event.detail.url,\n            \"fullUrl\": event.detail.fullUrl,\n            \"src\": event.detail.src\n          };\n        }\n      },\n      loading(event : UniWebViewLoadingEvent) {\n        console.log(JSON.stringify(event.detail));\n        if (this.autoTest) {\n          this.eventLoading = {\n            \"tagName\": event.target?.tagName,\n            \"type\": event.type,\n            \"src\": event.detail.src\n          };\n        }\n      },\n      load(event : UniWebViewLoadEvent) {\n        console.log(JSON.stringify(event.detail));\n        if (this.autoTest) {\n          this.eventLoad = {\n            \"tagName\": event.target?.tagName,\n            \"type\": event.type,\n            \"src\": event.detail.src\n          };\n        }\n      },\n      download(event : UniWebViewDownloadEvent) {\n        console.log(JSON.stringify(event.detail));\n        uni.showModal({\n          content: \"下载链接: \" + event.detail.url + \"\\n文件大小: \" + event.detail.contentLength / 1024 + \"KB\",\n          showCancel: false\n        });\n      },\n      confirm(event : UniInputConfirmEvent) {\n        let url = event.detail.value;\n        if (!url.startsWith('https://') && !url.startsWith('http://')) {\n          url = 'https://' + url;\n        }\n        this.src = url;\n      },\n      changeHorizontalScrollBarAccess(event : UniSwitchChangeEvent) {\n        this.horizontalScrollBarAccess = event.detail.value;\n      },\n      changeVerticalScrollBarAccess(event : UniSwitchChangeEvent) {\n        this.verticalScrollBarAccess = event.detail.value;\n      }\n    }\n  }\n</script>\n\n<style>\n  .margin-left-5 {\n    margin-left: 5px;\n  }\n\n  .align-items-center {\n    align-items: center;\n  }\n</style>\n",null,null],"names":[],"mappings":"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"}