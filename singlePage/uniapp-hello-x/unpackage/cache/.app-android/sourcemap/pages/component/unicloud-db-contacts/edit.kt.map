{"version":3,"sources":["pages/component/unicloud-db-contacts/edit.uvue","pages/component/unicloud-db-contacts/add.uvue?type=page","uni_modules/uni-upgrade-center-app/components/uni-upgrade-center-app/uni-upgrade-center-app.uvue","pages/component/unicloud-db-contacts/edit.uvue?type=page","uni_modules/test-invoke-network-api/utssdk/interface.uts"],"sourcesContent":["<template>\n  <scroll-view class=\"scroll-view\">\n    <unicloud-db ref=\"udb\" v-slot:default=\"{data, loading, error}\" :collection=\"collection\" :where=\"where\"\n      page-data=\"replace\">\n      <view v-if=\"error!=null\" class=\"error\">{{error.errMsg}}</view>\n      <view v-if=\"loading\" class=\"loading\">正在加载...</view>\n      <form v-if=\"data.length>0\" @submit=\"onFormSubmit\">\n        <view class=\"form-item\">\n          <text class=\"form-item-label\">姓名</text>\n          <input class=\"form-item-input\" placeholder=\"姓名\" name=\"username\" :value=\"data[0].getString('username')\" />\n        </view>\n        <view class=\"form-item\">\n          <text class=\"form-item-label\">电话</text>\n          <input class=\"form-item-input\" placeholder=\"电话\" name=\"mobile\" :value=\"data[0].getString('mobile')\" />\n        </view>\n        <view class=\"form-item\">\n          <text class=\"form-item-label\">邮箱</text>\n          <input class=\"form-item-input\" placeholder=\"邮箱地址\" name=\"email\" :value=\"data[0].getString('email')\" />\n        </view>\n        <view class=\"form-item\">\n          <text class=\"form-item-label\">备注</text>\n          <textarea class=\"form-item-input\" placeholder=\"备注\" name=\"comment\" maxlength=\"-1\" :value=\"data[0].getString('comment')\" />\n        </view>\n        <view class=\"form-item\">\n          <text class=\"form-item-label\">性别</text>\n          <radio-group class=\"radio-list\" name=\"gender\">\n            <view class=\"radio-item\" v-for=\"(item, _) in genderList\" :key=\"item.value\">\n              <radio :value=\"item.value\" :checked=\"item.value == data[0].getNumber('gender')\" />\n              <text>{{item.text}}</text>\n            </view>\n          </radio-group>\n        </view>\n        <view class=\"btn-group\">\n          <button class=\"btn-submit\" type=\"primary\" form-type=\"submit\">保存</button>\n          <button class=\"btn-delete\" type=\"warn\"\n            @click=\"remove(data[0].getString('_id'), data[0].getString('username'))\">删除联系人</button>\n        </view>\n      </form>\n    </unicloud-db>\n  </scroll-view>\n</template>\n\n<script>\n  import { COLLECTION_NAME, GenderType, GenderList, UNICLOUD_DB_CONTACTS_UPDATE, UNICLOUD_DB_CONTACTS_DELETE } from './types.uts'\n\n  export default {\n    data() {\n      return {\n        collection: '',\n        where: '',\n        genderList: GenderList as GenderType[],\n        whereID: '',\n        uniCloudElement: null as UniCloudDBElement | null\n      }\n    },\n    onLoad(options) {\n      this.collection = COLLECTION_NAME;\n      this.whereID = options['id'] as string;\n      this.where = `_id=='${this.whereID}'`;\n    },\n    onReady() {\n      this.uniCloudElement = this.$refs['udb'] as UniCloudDBElement\n    },\n    methods: {\n      onFormSubmit: function (e : UniFormSubmitEvent) {\n        const formData = e.detail.value\n        const genderString = formData['gender'] as string\n        formData['gender'] = (genderString.length > 0) ? parseInt(genderString) : -1\n        this.uniCloudElement!.update(this.whereID, formData, {\n          showToast: false,\n          needLoading: true,\n          needConfirm: false,\n          loadingTitle: \"正在保存...\",\n          success: (_ : UniCloudDBUpdateResult) => {\n            // TODO 后续通过 EventChannel 实现\n            uni.$emit(UNICLOUD_DB_CONTACTS_UPDATE, this.whereID)\n            setTimeout(() => {\n              uni.navigateBack()\n            }, 500)\n          },\n          fail: (err : any | null) => {\n            const error = err as UniCloudError\n            uni.showModal({\n              content: error.errMsg,\n              showCancel: false\n            })\n          }\n        })\n      },\n      remove(id : string | null, name : string | null) {\n        this.uniCloudElement!.remove(id!, {\n          needConfirm: true,\n          needLoading: true,\n          loadingTitle: \"正在删除...\",\n          confirmTitle: \"确定删除?\",\n          confirmContent: name,\n          success: (_ : UniCloudDBRemoveResult) => {\n            // TODO 后续通过 EventChannel 实现\n            uni.$emit(UNICLOUD_DB_CONTACTS_DELETE, this.whereID)\n            setTimeout(() => {\n              uni.navigateBack({\n                delta: 2\n              })\n            }, 500)\n          },\n          fail: (err : any | null) => {\n            const error = err as UniCloudError\n            uni.showModal({\n              content: error.errMsg,\n              showCancel: false\n            })\n          }\n        })\n      }\n    }\n  }\n</script>\n\n<style>\n  .page {\n    flex: 1;\n  }\n\n  .scroll-view {\n    padding: 15px;\n    flex: 1;\n  }\n\n  .loading {\n    align-items: center;\n  }\n\n  .form-item {\n    flex-direction: row;\n    margin-bottom: 15px;\n    align-items: center;\n  }\n\n  .form-item-label {\n    width: 45px;\n    margin-right: 10px;\n  }\n\n  .form-item-input {\n    flex: 1;\n    font-size: 14px;\n    color: #666;\n    border: 1px #e5e5e5 solid;\n    border-radius: 5px;\n    padding: 8px;\n  }\n\n  .radio-list {\n    flex-direction: row;\n  }\n\n  .radio-item {\n    flex-direction: row;\n    margin-right: 30px;\n    align-items: center;\n  }\n\n  .btn-group {\n    margin-top: 30px;\n  }\n\n  .btn-delete {\n    margin-top: 15px;\n  }\n</style>\n",null,null,null,null],"names":[],"mappings":"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"}