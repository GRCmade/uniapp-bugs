{"version":3,"sources":["pages/component/unicloud-db-contacts/list.uvue","pages/component/unicloud-db-contacts/list.uvue?type=page","pages/ask/index/index.uvue?type=page"],"sourcesContent":["<template>\n  <view class=\"page\">\n    <unicloud-db ref=\"udb\" class=\"udb\" v-slot:default=\"{data, pagination, loading, hasMore, error}\"\n      :collection=\"collection\" :page-size=\"15\" :getcount=\"true\" loadtime=\"manual\">\n      <view v-if=\"error!=null\" class=\"error\">{{error.errMsg}}</view>\n      <scroll-view ref=\"listView\" class=\"list-view\" @scrolltolower=\"loadMore()\">\n        <view class=\"list-item\" v-for=\"(item, _) in data\" @click=\"gotoDetailPage(item['_id'] as string)\">\n          <view class=\"list-item-fill\">\n            <text class=\"name\">{{item['username']}}</text>\n            <text class=\"mobile\">{{item['mobile']}}</text>\n          </view>\n        </view>\n      </scroll-view>\n      <uni-loading v-if=\"loading\" class=\"loading\" color=\"#999\" text=\"正在加载...\"></uni-loading>\n      <view v-if=\"data.length>0\" class=\"pagination\">\n        <text class=\"pagination-item\">{{data.length}} / {{pagination.count}}</text>\n      </view>\n    </unicloud-db>\n    <view class=\"btn-plus\" @click=\"gotoAddPage\">\n      <text class=\"btn-plus-text\">+</text>\n    </view>\n  </view>\n</template>\n\n<script>\n  import { COLLECTION_NAME, UNICLOUD_DB_CONTACTS_ADD, UNICLOUD_DB_CONTACTS_UPDATE, UNICLOUD_DB_CONTACTS_DELETE } from './types.uts'\n\n  export default {\n    data() {\n      return {\n        collection: COLLECTION_NAME,\n        uniCloudElement: null as UniCloudDBElement | null\n      }\n    },\n    onReady() {\n      // TODO 后续通过 EventChannel 实现\n      uni.$on(UNICLOUD_DB_CONTACTS_DELETE, this.onDataChange);\n      this.uniCloudElement = this.$refs['udb'] as UniCloudDBElement\n      this.uniCloudElement!.loadData()\n    },\n    onUnload() {\n      // TODO 后续通过 EventChannel 实现\n      uni.$off(UNICLOUD_DB_CONTACTS_ADD, this.onDataChange);\n      uni.$off(UNICLOUD_DB_CONTACTS_UPDATE, this.onDataChange);\n      uni.$off(UNICLOUD_DB_CONTACTS_DELETE, this.onDataChange);\n    },\n    onShow() {\n      // TODO 后续通过 EventChannel 实现\n      uni.$off(UNICLOUD_DB_CONTACTS_ADD, this.onDataChange);\n      uni.$off(UNICLOUD_DB_CONTACTS_UPDATE, this.onDataChange);\n    },\n    onPullDownRefresh() {\n      this.uniCloudElement!.loadData({\n        clear: true,\n        success: (_ : UniCloudDBGetResult) => {\n          uni.stopPullDownRefresh()\n        }\n      })\n    },\n    methods: {\n      loadMore() {\n        this.uniCloudElement!.loadMore()\n      },\n      gotoAddPage() {\n        // TODO 后续通过 EventChannel 实现\n        uni.$on(UNICLOUD_DB_CONTACTS_ADD, this.onDataChange);\n        uni.navigateTo({\n          url: './add'\n        })\n      },\n      gotoDetailPage(id : string) {\n        // TODO 后续通过 EventChannel 实现\n        uni.$on(UNICLOUD_DB_CONTACTS_UPDATE, this.onDataChange);\n        uni.navigateTo({\n          url: './detail?id=' + id\n        })\n      },\n      onDataChange(_ : string) {\n        this.uniCloudElement!.loadData({\n          clear: true\n        })\n      }\n    }\n  }\n</script>\n\n<style>\n  .page {\n    flex: 1;\n    flex-direction: column;\n  }\n\n  .loading {\n    margin: 20px;\n    align-self: center;\n  }\n\n  .udb {\n    flex: 1;\n    /* TODO */\n\n\n\n    flex-direction: column;\n  }\n\n  .list-view {\n    flex: 1;\n    flex-direction: column;\n  }\n\n  .list-item {\n    flex-direction: row;\n    padding: 10px;\n    background-color: #fff;\n    margin-bottom: 1px;\n  }\n\n  .mobile {\n    margin-top: 5px;\n  }\n\n  .btn-plus {\n    position: absolute;\n    width: 64px;\n    height: 64px;\n    right: 20px;\n    bottom: 20px;\n    align-items: center;\n    justify-content: center;\n    background-color: #1e90ff;\n    border-radius: 64px;\n  }\n\n  .btn-plus-text {\n    font-size: 30px;\n    color: #fff;\n  }\n\n  .pagination {\n    align-items: center;\n    background-color: #f8f8f8;\n    padding: 15px;\n  }\n</style>\n",null,null],"names":[],"mappings":";;;;;;;;;;;;;;;;;+BA0CU;+BANA;+BAMD;+BAaK;AA5BP;;gBAOH,MAAU;YAER,qCAAqC,IAAI,CAAC,YAAY;YACtD,IAAI,CAAC,eAAc,GAAI,IAAI,CAAC,OAAK,CAAC,MAAK,CAAE,EAAC,CAAE;YAC5C,IAAI,CAAC,eAAe,GAAE,QAAQ;QAChC;;iBACA,MAAW;YAET,mCAAmC,IAAI,CAAC,YAAY;YACpD,sCAAsC,IAAI,CAAC,YAAY;YACvD,sCAAsC,IAAI,CAAC,YAAY;QACzD;;mBACA,MAAS;YAEP,mCAAmC,IAAI,CAAC,YAAY;YACpD,sCAAsC,IAAI,CAAC,YAAY;QACzD;;0BACA,MAAoB;YAClB,IAAI,CAAC,eAAe,GAAE,QAAQ,CAAC;gBAC7B,IAAA,QAAO,IAAI;gBACX,IAAA,UAAS,IAAC,GAAI,oBAAwB;oBACpC;gBACF;aACD;QACH;;;;;;;;;eAzDF,mBAoBO,QAAA,SApBD,WAAM,SAAM;YAChB,YAec,wBAAA,SAfD,SAAI,OAAM,WAAM,OAC1B,gBAAY,KAAA,UAAU,EAAG,eAAW,EAAE,EAAG,cAAU,IAAI,EAAE,cAAS,oBAD3B,aAAO,kBAE/C,IAA8D,iGAAA,GAAA,EAAA;;;;;;;oBAAlD,IAAA,SAAK,IAAA;wBAAjB,mBAA8D,QAAA,qBAArC,WAAM,0BAAU,MAAM,MAAM,GAAA,CAAA;;;;;oBACrD,mBAOc,eAAA,SAPD,SAAI,YAAW,WAAM,aAAa,qBAAa,KAAA;wBAAE,KAAA,QAAQ;oBAAA;;wBACpE,mBAKO,UAAA,IAAA,EAAA,cAAA,UAAA,CALqC,MAAI,IAAhB,MAAM,GAAN,SAAI,UAAA,GAAA,CAAA;mCAApC,mBAKO,QAAA,SALD,WAAM,aAAuC,aAAK,KAAA;gCAAE,KAAA,cAAc,CAAC,IAAI,CAAA,MAAA,CAAA,EAAA,CAAA,MAAA;4BAAA;;gCAC3E,mBAGO,QAAA,SAHD,WAAM,mBAAgB;oCAC1B,mBAA8C,QAAA,SAAxC,WAAM,SAAM,gBAAG,IAAI,CAAA,WAAA,GAAA,CAAA;oCACzB,mBAA8C,QAAA,SAAxC,WAAM,WAAQ,gBAAG,IAAI,CAAA,SAAA,GAAA,CAAA;;;;;;;;;;+BAId;wBAAnB,YAAsF,wBAAA,qBAA1D,WAAM,WAAU,WAAM,QAAO,UAAK;;;;;oBAClD,IAAA,KAAK,MAAM,GAAA,CAAA;wBAAvB,mBAEO,QAAA,qBAFoB,WAAM;4BAC/B,mBAA2E,QAAA,SAArE,WAAM,oBAAiB,gBAAG,KAAK,MAAM,IAAE,QAAG,gBAAE,WAAW,KAAK,GAAA,CAAA;;;;;;;;;;YAGtE,mBAEO,QAAA,SAFD,WAAM,YAAY,aAAO,KAAA,WAAW;gBACxC,mBAAoC,QAAA,SAA9B,WAAM,kBAAgB;;;;;;aAW1B;aACA,iBAAyB;;;wBADzB,iCACA,qBAAiB,IAAG,CAAE,EAAC,CAAE;;;aA6B3B,WAAA,MAAW;YACT,IAAI,CAAC,eAAe,GAAE,QAAQ;QAChC;;aACA,cAAA,MAAc;YAEZ,kCAAkC,IAAI,CAAC,YAAY;YACnD,iCACE,MAAK;QAET;;aACA,iBAAA,IAAe,IAAK,MAAM,EAAE;YAE1B,qCAAqC,IAAI,CAAC,YAAY;YACtD,iCACE,MAAK,iBAAiB;QAE1B;;aACA,eAAA,IAAa,GAAI,MAAM,EAAE;YACvB,IAAI,CAAC,eAAe,GAAE,QAAQ,CAAC;gBAC7B,IAAA,QAAO,IAAG;aACX;QACH;;;sBArBA;sBAGA;sBAOA,iBAAe,IAAK,MAAM;sBAO1B,eAAa,GAAI,MAAM;;;;;;;;;;;;;;;;;;;;;AAM3B"}