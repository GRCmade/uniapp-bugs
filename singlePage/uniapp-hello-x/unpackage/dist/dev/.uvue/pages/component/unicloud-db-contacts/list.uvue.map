{"version":3,"file":"pages/component/unicloud-db-contacts/list.uvue","names":[],"sources":["pages/component/unicloud-db-contacts/list.uvue"],"sourcesContent":["<template>\n  <view class=\"page\">\n    <unicloud-db ref=\"udb\" class=\"udb\" v-slot:default=\"{data, pagination, loading, hasMore, error}\"\n      :collection=\"collection\" :page-size=\"15\" :getcount=\"true\" loadtime=\"manual\">\n      <view v-if=\"error!=null\" class=\"error\">{{error.errMsg}}</view>\n      <scroll-view ref=\"listView\" class=\"list-view\" @scrolltolower=\"loadMore()\">\n        <view class=\"list-item\" v-for=\"(item, _) in data\" @click=\"gotoDetailPage(item['_id'] as string)\">\n          <view class=\"list-item-fill\">\n            <text class=\"name\">{{item['username']}}</text>\n            <text class=\"mobile\">{{item['mobile']}}</text>\n          </view>\n        </view>\n      </scroll-view>\n      <uni-loading v-if=\"loading\" class=\"loading\" color=\"#999\" text=\"正在加载...\"></uni-loading>\n      <view v-if=\"data.length>0\" class=\"pagination\">\n        <text class=\"pagination-item\">{{data.length}} / {{pagination.count}}</text>\n      </view>\n    </unicloud-db>\n    <view class=\"btn-plus\" @click=\"gotoAddPage\">\n      <text class=\"btn-plus-text\">+</text>\n    </view>\n  </view>\n</template>\n\n<script>\n  import { COLLECTION_NAME, UNICLOUD_DB_CONTACTS_ADD, UNICLOUD_DB_CONTACTS_UPDATE, UNICLOUD_DB_CONTACTS_DELETE } from './types.uts'\n\n  export default {\n    data() {\n      return {\n        collection: COLLECTION_NAME,\n        uniCloudElement: null as UniCloudDBElement | null\n      }\n    },\n    onReady() {\n      // TODO 后续通过 EventChannel 实现\n      uni.$on(UNICLOUD_DB_CONTACTS_DELETE, this.onDataChange);\n      this.uniCloudElement = this.$refs['udb'] as UniCloudDBElement\n      this.uniCloudElement!.loadData()\n    },\n    onUnload() {\n      // TODO 后续通过 EventChannel 实现\n      uni.$off(UNICLOUD_DB_CONTACTS_ADD, this.onDataChange);\n      uni.$off(UNICLOUD_DB_CONTACTS_UPDATE, this.onDataChange);\n      uni.$off(UNICLOUD_DB_CONTACTS_DELETE, this.onDataChange);\n    },\n    onShow() {\n      // TODO 后续通过 EventChannel 实现\n      uni.$off(UNICLOUD_DB_CONTACTS_ADD, this.onDataChange);\n      uni.$off(UNICLOUD_DB_CONTACTS_UPDATE, this.onDataChange);\n    },\n    onPullDownRefresh() {\n      this.uniCloudElement!.loadData({\n        clear: true,\n        success: (_ : UniCloudDBGetResult) => {\n          uni.stopPullDownRefresh()\n        }\n      })\n    },\n    methods: {\n      loadMore() {\n        this.uniCloudElement!.loadMore()\n      },\n      gotoAddPage() {\n        // TODO 后续通过 EventChannel 实现\n        uni.$on(UNICLOUD_DB_CONTACTS_ADD, this.onDataChange);\n        uni.navigateTo({\n          url: './add'\n        })\n      },\n      gotoDetailPage(id : string) {\n        // TODO 后续通过 EventChannel 实现\n        uni.$on(UNICLOUD_DB_CONTACTS_UPDATE, this.onDataChange);\n        uni.navigateTo({\n          url: './detail?id=' + id\n        })\n      },\n      onDataChange(_ : string) {\n        this.uniCloudElement!.loadData({\n          clear: true\n        })\n      }\n    }\n  }\n</script>\n\n<style>\n  .page {\n    flex: 1;\n    flex-direction: column;\n  }\n\n  .loading {\n    margin: 20px;\n    align-self: center;\n  }\n\n  .udb {\n    flex: 1;\n    /* TODO */\n\n\n\n    flex-direction: column;\n  }\n\n  .list-view {\n    flex: 1;\n    flex-direction: column;\n  }\n\n  .list-item {\n    flex-direction: row;\n    padding: 10px;\n    background-color: #fff;\n    margin-bottom: 1px;\n  }\n\n  .mobile {\n    margin-top: 5px;\n  }\n\n  .btn-plus {\n    position: absolute;\n    width: 64px;\n    height: 64px;\n    right: 20px;\n    bottom: 20px;\n    align-items: center;\n    justify-content: center;\n    background-color: #1e90ff;\n    border-radius: 64px;\n  }\n\n  .btn-plus-text {\n    font-size: 30px;\n    color: #fff;\n  }\n\n  .pagination {\n    align-items: center;\n    background-color: #f8f8f8;\n    padding: 15px;\n  }\n</style>\n"],"mappings":";EAyBE,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,EAAE,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;;EAEhI,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE;IACb,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE;MACL,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE;QACL,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;QAC3B,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,EAAE,CAAC,CAAC,CAAC;MAClD;IACF,CAAC;IACD,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE;MACR,CAAC,EAAE,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC;MAC3B,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;MACvD,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;MAC5D,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;IACjC,CAAC;IACD,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE;MACT,CAAC,EAAE,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC;MAC3B,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;MACrD,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;MACxD,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;IAC1D,CAAC;IACD,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE;MACP,CAAC,EAAE,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC;MAC3B,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;MACrD,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC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"}