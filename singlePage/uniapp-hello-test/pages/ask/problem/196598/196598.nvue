<template>
	<view>
		<map id="test_map" style="width: 750rpx; height: 300px;" :show-location="true" :markers="markers"
			:longitude="map.longitude" :latitude="map.latitude">
		</map>
		<button @click="dingwei">添加marker</button>
	</view>
</template>

<script>
	export default {
		data() {
			return {
				map: {
					longitude: '', //经度  
					latitude: '', //纬度  

				},
				markers: [{
					id: 1,
					latitude: '39.9496252',
					longitude: '116.3485888',
					iconPath: '/static/app-plus/location@3x.png',
					width: 32,
					height: 32
				}]
			}
		},
		onLoad() {
			let _this = this;
			uni.getLocation({
				type: 'gcj02',
				success: function(res) {
					console.log(res)
					_this.map.longitude = res.longitude;
					_this.map.latitude = res.latitude;
				}
			});

		},
		methods: {
			dingwei() {
				//官方API uni.createMapContext(mapId,this)  
				//其中API对应方法之一: moveToLocation(OBJECT) //将地图中心移动到当前定位点，需要配合map组件的show-location使用  

				//需要实现的目标:定位平移 到指定坐标位置.比如案例中定位到"北京西站"  
				//实际结果: 在iPhone8中,定位平移 到本人真实的当前位置  
				const context = uni.createMapContext('test_map', this)
				let obj = {
					id: this.markers.length+2,
					latitude: '39.9496252',
					longitude: '116.3485888',
					iconPath: `/static/app-plus/location@3x.png`,
					width: 50,
					height: 50
				}
				this.markers.push(obj)
				context.addMarkers({
					markers:this.markers
				})
			}
		}
	}
</script>

<style scoped>
</style>